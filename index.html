<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta http-equiv="refresh" content="0; URL=pages/login.html" />

  <title>âœ¨ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Tajawal', sans-serif;
      background: radial-gradient(circle at top right, #0a84ff, #001f3f 70%);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
    }

    .container {
      background: rgba(255, 255, 255, 0.1);
      padding: 35px;
      border-radius: 16px;
      backdrop-filter: blur(12px);
      box-shadow: 0 10px 35px rgba(0, 0, 0, 0.3);
      width: 360px;
      text-align: center;
      animation: fadeIn 0.8s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: #ffd369;
      font-weight: 700;
      font-size: 1.4rem;
      margin-bottom: 8px;
    }

    p.subtitle {
      font-size: 0.9rem;
      color: #ccc;
      margin-bottom: 25px;
    }

    input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: none;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
      font-size: 15px;
      transition: 0.3s;
    }

    input:focus {
      background: rgba(255, 255, 255, 0.3);
      outline: none;
    }

    .role-selection {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .role-btn {
      flex: 1;
      margin: 0 5px;
      padding: 12px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      background: transparent;
      color: #fff;
      cursor: pointer;
      font-size: 15px;
      transition: 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .role-btn:hover {
      border-color: #ffd369;
      color: #ffd369;
    }

    .role-btn.active {
      background: #ffd369;
      color: #222;
      border-color: #ffd369;
      font-weight: 700;
    }

    button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #007bff, #0056b3);
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      transform: scale(1.03);
      background: linear-gradient(135deg, #0056b3, #004494);
    }

    p {
      margin-top: 15px;
      font-size: 14px;
      color: #ccc;
    }

    a {
      color: #ffd369;
      text-decoration: none;
      font-weight: 600;
    }

    a:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>ğŸ‘‹ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
    <p class="subtitle">Ø§Ù†Ø¶Ù… Ø§Ù„Ø¢Ù† ÙˆØ§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ù†Ø­Ùˆ ÙØ±Øµ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØ©!</p>

    <form id="signupForm">
      <input type="text" name="full_name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required />
      <input type="email" name="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required />
      <input type="password" name="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required />

      <div class="role-selection">
        <button type="button" class="role-btn" data-role="student">ğŸ‘¨â€ğŸ“ Ø·Ø§Ù„Ø¨</button>
        <button type="button" class="role-btn" data-role="company">ğŸ¢ Ø´Ø±ÙƒØ©</button>
      </div>

      <input type="hidden" name="role" id="selectedRole" required />

      <button type="submit">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</button>
    </form>

    <p>Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="pages/login.html">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a></p>
  </div>
<script>
  const roleButtons = document.querySelectorAll(".role-btn");
  let selectedRole = "student";

  // âœ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø²Ø± Ø§Ù„Ù†Ø´Ø· (Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø´Ø±ÙƒØ©)
  roleButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      roleButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      selectedRole = btn.getAttribute("data-role");
    });
  });

  // âœ… Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¨Ø³ÙŠØ·Ø© ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰
  function showAlert(msg, type = "info") {
    let alertBox = document.querySelector(".alert-box");
    if (!alertBox) {
      alertBox = document.createElement("div");
      alertBox.className = "alert-box";
      document.body.appendChild(alertBox);
    }

    alertBox.textContent = msg;
    alertBox.style.position = "fixed";
    alertBox.style.top = "20px";
    alertBox.style.left = "50%";
    alertBox.style.transform = "translateX(-50%)";
    alertBox.style.padding = "12px 20px";
    alertBox.style.borderRadius = "10px";
    alertBox.style.color = type === "success" ? "#155724" : "#721c24";
    alertBox.style.backgroundColor = type === "success" ? "#d4edda" : "#f8d7da";
    alertBox.style.border = type === "success" ? "2px solid #28a745" : "2px solid #dc3545";
    alertBox.style.fontWeight = "bold";
    alertBox.style.zIndex = "9999";
    alertBox.style.transition = "opacity 0.3s ease";

    setTimeout(() => {
      alertBox.style.opacity = "0";
      setTimeout(() => alertBox.remove(), 500);
    }, 3000);
  }

  // âœ… Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
  document.getElementById("signupForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = Object.fromEntries(new FormData(e.target));
    formData.role = selectedRole;
    formData.user_type = selectedRole === "student" ? "job_seeker" : "company";
    formData.status = "active";

    try {
      const res = await fetch("/.netlify/functions/signup", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData),
      });

      const result = await res.json();

      if (!res.ok) {
        showAlert(result.message || "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨.", "error");
        return;
      }

      // âœ… Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
      showAlert("âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ùƒ Ø§Ù„Ø¢Ù†...", "success");

      // ğŸ§­ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© signup.html Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ pages
      setTimeout(() => {
        window.location.href = "../pages/signup.html";
      }, 1500);

    } catch (err) {
      console.error("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±:", err);
      showAlert("âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±.", "error");
    }
  });
</script>

  
  
</body>
</html>
