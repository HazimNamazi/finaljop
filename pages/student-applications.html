<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø·Ù„Ø¨Ø§ØªÙŠ</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<style>
body { background:#eef1f5; font-family:'Tajawal'; margin:0; padding:20px; }
.card {
  background:white; padding:20px; margin-bottom:15px;
  border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1);
}
.title { font-size:18px; font-weight:700; color:#007bff; }
.status { font-weight:bold; margin-top:10px; }
</style>
</head>

<body>

<h2>ğŸ“„ Ø·Ù„Ø¨Ø§ØªÙŠ</h2>
<div id="list"></div>

<script>
const user = JSON.parse(localStorage.getItem("user"));
if (!user || user.user_type !== "student") {
  alert("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒØ·Ø§Ù„Ø¨.");
  location.href = "login.html";
}

async function loadApplications() {
  const res = await fetch(`/.netlify/functions/get-student-applications?student_id=${user.id}`);
  const data = await res.json();

  const container = document.getElementById("list");
  container.innerHTML = "";

  if (!data.applications.length) {
    container.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>";
    return;
  }

  data.applications.forEach(app => {
    container.innerHTML += `
      <div class="card">
        <div class="title">${app.job_title} - ${app.company_name}</div>
        <div>ğŸ“ ${app.location} | ğŸ’° ${app.salary_range}</div>
        <div>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…: ${app.created_at}</div>
        <div class="status">Ø§Ù„Ø­Ø§Ù„Ø©: ${app.status}</div>
        <a href="${app.cv_link}" target="_blank">Ø¹Ø±Ø¶ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©</a>
      </div>
    `;
  });
}

loadApplications();
</script>

</body>
</html>
