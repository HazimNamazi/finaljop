<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“© Ø±Ø³Ø§Ø¦Ù„ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background:#f4f6f9;
      padding:30px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    h2 {
      margin: 0;
      color: #001f3f;
    }

    .back-btn {
      background: #001f3f;
      color: #ffd369;
      padding: 8px 16px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      transition: 0.2s;
    }

    .back-btn:hover {
      background: #003f7f;
      transform: scale(1.05);
    }

    table {
      width:100%;
      background:#fff;
      border-collapse:collapse;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    th, td {
      padding:12px;
      border-bottom:1px solid #ddd;
      text-align:center;
      font-size: 14px;
    }

    th {
      background:#001f3f;
      color:#fff;
    }
  </style>
</head>

<body>

<!-- ğŸ”™ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ -->
<div class="header">
  <h2>ğŸ“© Ø±Ø³Ø§Ø¦Ù„ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
  <a href="admin-dashboard.html" class="back-btn">â¬…ï¸ Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</a>
</div>

<table id="messagesTable"></table>

<script>
const admin = JSON.parse(localStorage.getItem("user"));
if (!admin || admin.user_type !== "admin") {
  alert("âŒ ØºÙŠØ± Ù…ØµØ±Ø­");
  location.href = "login.html";
}

async function loadMessages() {
  const res = await fetch("/.netlify/functions/get-contact-messages");
  const messages = await res.json();

  let html = `
    <tr>
      <th>Ø§Ù„Ø§Ø³Ù…</th>
      <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
      <th>Ø§Ù„Ø±Ø³Ø§Ù„Ø©</th>
      <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
    </tr>
  `;

  if (!messages.length) {
    html += `
      <tr>
        <td colspan="4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„</td>
      </tr>
    `;
  }

  messages.forEach(m => {
    html += `
      <tr>
        <td>${m.name}</td>
        <td>${m.email}</td>
        <td>${m.message}</td>
        <td>${new Date(m.created_at).toLocaleString("ar-SA")}</td>
      </tr>
    `;
  });

  document.getElementById("messagesTable").innerHTML = html;
}

loadMessages();
</script>

</body>
</html>
