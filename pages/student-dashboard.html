<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ÙˆØ±Ø´ Ø§Ù„Ø·Ù„Ø§Ø¨</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Tajawal', sans-serif; background: #eef1f5; padding: 20px; }
    .workshop {
      background: #fff; margin-bottom: 15px; padding: 15px; border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,.1);
    }
    button {
      padding: 8px 15px; background: #007bff; color: #fff; border: none; border-radius: 8px; cursor: pointer;
    }
  </style>
</head>
<body>

<h1>ğŸ“˜ Ø§Ù„ÙˆØ±Ø´ Ø§Ù„Ù…ØªØ§Ø­Ø©</h1>

<div id="list"></div>

<script>
async function load() {
  const res = await fetch("/.netlify/functions/get-workshops");
  const data = await res.json();

  let html = "";

  data.forEach(w => {
    html += `
      <div class="workshop">
        <h2>${w.title}</h2>
        <p>${w.description}</p>
        <p>ğŸ“… ${w.date} â€“ â° ${w.time}</p>
        <button onclick="attend(${w.id})">ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±</button>
      </div>
    `;
  });

  document.getElementById("list").innerHTML = html;
}

async function attend(id) {
  const student_id = localStorage.getItem("user_id");

  await fetch("/.netlify/functions/attend-workshop", {
    method: "POST",
    body: JSON.stringify({ student_id, workshop_id: id })
  });

  alert("âœ”ï¸ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø­Ø¶ÙˆØ±Ùƒ");
}

load();
</script>

</body>
</html>
